<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script>
       async function start_me_up(){
        get_person()
       }
       async function get_person(){
            const response  = await fetch("https://script.google.com/macros/s/AKfycbyxC9BPrve_VigSWccENfzxSb1vMu649aHW9A_VsEofR1CR1buFioHyn4DG30wl5r7xwQ/exec")

            const text = await response.text();
            console.log(text)
            const rec = JSON.parse(text)
            console.log(rec);
            let url=rec.fields.report_link
            url=url.split(".com/").join(".com/embed/")+"&hide_person=true"
            tag("report_link").src=url
//            tag("link").src= rec.fields.report_link
            tag("full_name").innerHTML = rec.fields.full_name || ""
            tag("birth").innerHTML = rec.fields.birth || ""
            tag("birthplace").innerHTML = rec.fields.birthplace || ""
            tag("death").innerHTML = rec.fields.death || ""
            tag("deathplace").innerHTML = rec.fields.deathplace || ""

            if(rec.fields.url){
                newwindow=window.open(rec.fields.url,"wikipedia");
                if (window.focus) {newwindow.focus()}     
            }

            newwindow=window.open(rec.fields.link,"family-search");
            if (window.focus) {newwindow.focus()}     

            window.focus()
        }
        
        function tag(id){
            return document.getElementById(id)
        }
       

    </script>
</head>
<body onload="start_me_up()">
<table><tr><td>
    <div id="full_name" style="font-size:2rem"></div>
    <div><table>
        <tr><td>Born</td><td id="birth"></td></tr>
        <tr><td>Birthplace</td><td id="birthplace"></td></tr>
        <tr><td>Died</td><td id="death"></td></tr>
        <tr><td>Death place</td><td id="deathplace"></td></tr>
        <tr><td colspan="2">
            <button onclick="get_person()">Next Person</button>
        </td></tr></table>    
    </div>

        <iframe id="report_link" class="airtable-embed" frameborder="0" onmousewheel="" width="250" height="430" style="background: transparent; border: 1px solid #ccc;"></iframe>

    

</body>
</html>